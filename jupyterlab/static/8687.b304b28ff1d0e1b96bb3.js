(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8687],{58687:()=>{"use strict";if(!L.DomUtil.setTransform){L.DomUtil.setTransform=function(t,e,i){var a=e||new L.Point(0,0);t.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?"translate("+a.x+"px,"+a.y+"px)":"translate3d("+a.x+"px,"+a.y+"px,0)")+(i?" scale("+i+")":"")}}L.CanvasLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function t(e){this._map=null;this._canvas=null;this._frame=null;this._delegate=null;L.setOptions(this,e)},delegate:function t(e){this._delegate=e;return this},needRedraw:function t(){if(!this._frame){this._frame=L.Util.requestAnimFrame(this.drawLayer,this)}return this},_onLayerDidResize:function t(e){this._canvas.width=e.newSize.x;this._canvas.height=e.newSize.y},_onLayerDidMove:function t(){var e=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,e);this.drawLayer()},getEvents:function t(){var e={resize:this._onLayerDidResize,moveend:this._onLayerDidMove};if(this._map.options.zoomAnimation&&L.Browser.any3d){e.zoomanim=this._animateZoom}return e},onAdd:function t(e){console.log("canvas onAdd",this);this._map=e;this._canvas=L.DomUtil.create("canvas","leaflet-layer");this.tiles={};var i=this._map.getSize();this._canvas.width=i.x;this._canvas.height=i.y;var a=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(a?"animated":"hide"));this.options.pane.appendChild(this._canvas);e.on(this.getEvents(),this);var n=this._delegate||this;n.onLayerDidMount&&n.onLayerDidMount();this.needRedraw();var o=this;setTimeout((function(){o._onLayerDidMove()}),0)},onRemove:function t(e){var i=this._delegate||this;i.onLayerWillUnmount&&i.onLayerWillUnmount();this.options.pane.removeChild(this._canvas);e.off(this.getEvents(),this);this._canvas=null},addTo:function t(e){e.addLayer(this);return this},drawLayer:function t(){var e=this._map.getSize();var i=this._map.getBounds();var a=this._map.getZoom();var n=this._map.options.crs.project(this._map.getCenter());var o=this._map.options.crs.project(this._map.containerPointToLatLng(this._map.getSize()));var r=this._delegate||this;r.onDrawLayer&&r.onDrawLayer({layer:this,canvas:this._canvas,bounds:i,size:e,zoom:a,center:n,corner:o});this._frame=null},_setTransform:function t(e,i,a){var n=i||new L.Point(0,0);e.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(a?" scale("+a+")":"")},_animateZoom:function t(e){var i=this._map.getZoomScale(e.zoom);var a=L.Layer?this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),e.zoom,e.center):this._map._getCenterOffset(e.center)._multiplyBy(-i).subtract(this._map._getMapPanePos());L.DomUtil.setTransform(this._canvas,a,i)}});L.canvasLayer=function(t){return new L.CanvasLayer(t)};L.Control.Velocity=L.Control.extend({options:{position:"bottomleft",emptyString:"Unavailable",angleConvention:"bearingCCW",showCardinal:false,speedUnit:"m/s",directionString:"Direction",speedString:"Speed",onAdd:null,onRemove:null},onAdd:function t(e){this._container=L.DomUtil.create("div","leaflet-control-velocity");L.DomEvent.disableClickPropagation(this._container);e.on("mousemove",this._onMouseMove,this);this._container.innerHTML=this.options.emptyString;if(this.options.leafletVelocity.options.onAdd)this.options.leafletVelocity.options.onAdd();return this._container},onRemove:function t(e){e.off("mousemove",this._onMouseMove,this);if(this.options.leafletVelocity.options.onRemove)this.options.leafletVelocity.options.onRemove()},vectorToSpeed:function t(e,i,a){var n=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));if(a==="k/h"){return this.meterSec2kilometerHour(n)}else if(a==="kt"){return this.meterSec2Knots(n)}else{return n}},vectorToDegrees:function t(e,i,a){if(a.endsWith("CCW")){i=i>0?i=-i:Math.abs(i)}var n=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));var o=Math.atan2(e/n,i/n);var r=o*180/Math.PI+180;if(a==="bearingCW"||a==="meteoCCW"){r+=180;if(r>=360)r-=360}return r},degreesToCardinalDirection:function t(e){var i="";if(e>=0&&e<11.25||e>=348.75){i="N"}else if(e>=11.25&&e<33.75){i="NNW"}else if(e>=33.75&&e<56.25){i="NW"}else if(e>=56.25&&e<78.75){i="WNW"}else if(e>=78.25&&e<101.25){i="W"}else if(e>=101.25&&e<123.75){i="WSW"}else if(e>=123.75&&e<146.25){i="SW"}else if(e>=146.25&&e<168.75){i="SSW"}else if(e>=168.75&&e<191.25){i="S"}else if(e>=191.25&&e<213.75){i="SSE"}else if(e>=213.75&&e<236.25){i="SE"}else if(e>=236.25&&e<258.75){i="ESE"}else if(e>=258.75&&e<281.25){i="E"}else if(e>=281.25&&e<303.75){i="ENE"}else if(e>=303.75&&e<326.25){i="NE"}else if(e>=326.25&&e<348.75){i="NNE"}return i},meterSec2Knots:function t(e){return e/.514},meterSec2kilometerHour:function t(e){return e*3.6},_onMouseMove:function t(e){var i=this;var a=this.options.leafletVelocity._map.containerPointToLatLng(L.point(e.containerPoint.x,e.containerPoint.y));var n=this.options.leafletVelocity._windy.interpolatePoint(a.lng,a.lat);var o="";if(n&&!isNaN(n[0])&&!isNaN(n[1])&&n[2]){var r=i.vectorToDegrees(n[0],n[1],this.options.angleConvention);var s=this.options.showCardinal?" (".concat(i.degreesToCardinalDirection(r),") "):"";o="<strong> ".concat(this.options.velocityType," ").concat(this.options.directionString,": </strong> ").concat(r.toFixed(2),"Â°").concat(s,", <strong> ").concat(this.options.velocityType," ").concat(this.options.speedString,": </strong> ").concat(i.vectorToSpeed(n[0],n[1],this.options.speedUnit).toFixed(2)," ").concat(this.options.speedUnit)}else{o=this.options.emptyString}i._container.innerHTML=o}});L.Map.mergeOptions({positionControl:false});L.Map.addInitHook((function(){if(this.options.positionControl){this.positionControl=new L.Control.MousePosition;this.addControl(this.positionControl)}}));L.control.velocity=function(t){return new L.Control.Velocity(t)};L.VelocityLayer=(L.Layer?L.Layer:L.Class).extend({options:{displayValues:true,displayOptions:{velocityType:"Velocity",position:"bottomleft",emptyString:"No velocity data"},maxVelocity:10,colorScale:null,data:null},_map:null,_canvasLayer:null,_windy:null,_context:null,_timer:0,_mouseControl:null,initialize:function t(e){L.setOptions(this,e)},onAdd:function t(e){this._paneName=this.options.paneName||"overlayPane";var i=e._panes.overlayPane;if(e.getPane){i=e.getPane(this._paneName);if(!i){i=e.createPane(this._paneName)}}this._canvasLayer=L.canvasLayer({pane:i}).delegate(this);this._canvasLayer.addTo(e);this._map=e},onRemove:function t(e){this._destroyWind()},setData:function t(e){this.options.data=e;if(this._windy){this._windy.setData(e);this._clearAndRestart()}this.fire("load")},setOpacity:function t(e){console.log("this._canvasLayer",this._canvasLayer);this._canvasLayer.setOpacity(e)},setOptions:function t(e){this.options=Object.assign(this.options,e);if(e.hasOwnProperty("displayOptions")){this.options.displayOptions=Object.assign(this.options.displayOptions,e.displayOptions);this._initMouseHandler(true)}if(e.hasOwnProperty("data"))this.options.data=e.data;if(this._windy){this._windy.setOptions(e);if(e.hasOwnProperty("data"))this._windy.setData(e.data);this._clearAndRestart()}this.fire("load")},onDrawLayer:function t(e,i){var a=this;if(!this._windy){this._initWindy(this);return}if(!this.options.data){return}if(this._timer)clearTimeout(a._timer);this._timer=setTimeout((function(){a._startWindy()}),750)},_startWindy:function t(){var e=this._map.getBounds();var i=this._map.getSize();this._windy.start([[0,0],[i.x,i.y]],i.x,i.y,[[e._southWest.lng,e._southWest.lat],[e._northEast.lng,e._northEast.lat]])},_initWindy:function e(i){var a=Object.assign({canvas:i._canvasLayer._canvas,map:this._map},i.options);this._windy=new t(a);this._context=this._canvasLayer._canvas.getContext("2d");this._canvasLayer._canvas.classList.add("velocity-overlay");this.onDrawLayer();this._map.on("dragstart",i._windy.stop);this._map.on("dragend",i._clearAndRestart);this._map.on("zoomstart",i._windy.stop);this._map.on("zoomend",i._clearAndRestart);this._map.on("resize",i._clearWind);this._initMouseHandler(false)},_initMouseHandler:function t(e){if(e){this._map.removeControl(this._mouseControl);this._mouseControl=false}if(!this._mouseControl&&this.options.displayValues){var i=this.options.displayOptions||{};i["leafletVelocity"]=this;this._mouseControl=L.control.velocity(i).addTo(this._map)}},_clearAndRestart:function t(){if(this._context)this._context.clearRect(0,0,3e3,3e3);if(this._windy)this._startWindy()},_clearWind:function t(){if(this._windy)this._windy.stop();if(this._context)this._context.clearRect(0,0,3e3,3e3)},_destroyWind:function t(){if(this._timer)clearTimeout(this._timer);if(this._windy)this._windy.stop();if(this._context)this._context.clearRect(0,0,3e3,3e3);if(this._mouseControl)this._map.removeControl(this._mouseControl);this._mouseControl=null;this._windy=null;this._map.removeLayer(this._canvasLayer)}});L.velocityLayer=function(t){return new L.VelocityLayer(t)};var t=function t(e){var i=e.minVelocity||0;var a=e.maxVelocity||10;var n=(e.velocityScale||.005)*(Math.pow(window.devicePixelRatio,1/3)||1);var o=e.particleAge||90;var r=e.lineWidth||1;var s=e.particleMultiplier||1/300;var l=Math.pow(window.devicePixelRatio,1/3)||1.6;var h=e.frameRate||15;var c=1e3/h;var f=.97;var v=["rgb(36,104, 180)","rgb(60,157, 194)","rgb(128,205,193 )","rgb(151,218,168 )","rgb(198,231,181)","rgb(238,247,217)","rgb(255,238,159)","rgb(252,217,125)","rgb(255,182,100)","rgb(252,150,75)","rgb(250,112,52)","rgb(245,64,32)","rgb(237,45,28)","rgb(220,24,32)","rgb(180,0,35)"];var d=e.colorScale||v;var u=[NaN,NaN,null];var p;var m;var y=e.data;var _;var g,w,M,x,C,b;var P=function t(e){y=e};var S=function t(e){if(e.hasOwnProperty("minVelocity"))i=e.minVelocity;if(e.hasOwnProperty("maxVelocity"))a=e.maxVelocity;if(e.hasOwnProperty("velocityScale"))n=(e.velocityScale||.005)*(Math.pow(window.devicePixelRatio,1/3)||1);if(e.hasOwnProperty("particleAge"))o=e.particleAge;if(e.hasOwnProperty("lineWidth"))r=e.lineWidth;if(e.hasOwnProperty("particleMultiplier"))s=e.particleMultiplier;if(e.hasOwnProperty("opacity"))f=+e.opacity;if(e.hasOwnProperty("frameRate"))h=e.frameRate;c=1e3/h};var D=function t(e,i,a,n,o,r){var s=1-e;var l=1-i;var h=s*l,c=e*l,f=s*i,v=e*i;var d=a[0]*h+n[0]*c+o[0]*f+r[0]*v;var u=a[1]*h+n[1]*c+o[1]*f+r[1]*v;return[d,u,Math.sqrt(d*d+u*u)]};var T=function t(e,i){var a=e.data,n=i.data;return{header:e.header,data:function t(e){return[a[e],n[e]]},interpolate:D}};var O=function t(e){var i=null,a=null,n=null;e.forEach((function(t){switch(t.header.parameterCategory+","+t.header.parameterNumber){case"1,2":case"2,2":i=t;break;case"1,3":case"2,3":a=t;break;default:n=t}}));return T(i,a)};var W=function t(e,i){var a=true;if(e.length<2)a=false;if(!a)console.log("Windy Error: data must have at least two components (u,v)");p=O(e);var n=p.header;if(n.hasOwnProperty("gridDefinitionTemplate")&&n.gridDefinitionTemplate!=0)a=false;if(!a){console.log("Windy Error: Only data with Latitude_Longitude coordinates is supported")}a=true;g=n.lo1;w=n.la1;M=n.dx;x=n.dy;C=n.nx;b=n.ny;if(n.hasOwnProperty("scanMode")){var o=n.scanMode.toString(2);o=("0"+o).slice(-8);var r=o.split("").map(Number).map(Boolean);if(r[0])M=-M;if(r[1])x=-x;if(r[2])a=false;if(r[3])a=false;if(r[4])a=false;if(r[5])a=false;if(r[6])a=false;if(r[7])a=false;if(!a)console.log("Windy Error: Data with scanMode: "+n.scanMode+" is not supported.")}_=new Date(n.refTime);_.setHours(_.getHours()+n.forecastTime);m=[];var s=0;var l=Math.floor(C*M)>=360;for(var h=0;h<b;h++){var c=[];for(var f=0;f<C;f++,s++){c[f]=p.data(s)}if(l){c.push(c[0])}m[h]=c}i({date:_,interpolate:R})};var R=function t(e,i){if(!m)return null;var a=A(e-g,360)/M;var n=(w-i)/x;var o=Math.floor(a),r=o+1;var s=Math.floor(n),l=s+1;var h;if(h=m[s]){var c=h[o];var f=h[r];if(N(c)&&N(f)&&(h=m[l])){var v=h[o];var d=h[r];if(N(v)&&N(d)){return p.interpolate(a-o,n-s,c,f,v,d)}}}return null};var N=function t(e){return e!==null&&e!==undefined};var A=function t(e,i){return e-i*Math.floor(e/i)};var z=function t(e,i){return Math.max(i[0],Math.min(e,i[1]))};var E=function t(){return/android|blackberry|iemobile|ipad|iphone|ipod|opera mini|webos/i.test(navigator.userAgent)};var V=function t(e,i,a,n,o,r,s){var l=s[0]*r;var h=s[1]*r;var c=U(e,i,a,n,o);s[0]=c[0]*l+c[2]*h;s[1]=c[1]*l+c[3]*h;return s};var U=function t(e,i,a,n,o){var r=2*Math.PI;var s=5;var l=i<0?s:-s;var h=a<0?s:-s;var c=j(a,i+l);var f=j(a+h,i);var v=Math.cos(a/360*r);return[(c[0]-n)/l/v,(c[1]-o)/l/v,(f[0]-n)/h,(f[1]-o)/h]};var k=function t(e,i,a){function n(t,i){var a=e[Math.round(t)];return a&&a[Math.round(i)]||u}n.release=function(){e=[]};n.randomize=function(t){var e,a;var o=0;do{e=Math.round(Math.floor(Math.random()*i.width)+i.x);a=Math.round(Math.floor(Math.random()*i.height)+i.y)}while(n(e,a)[2]===null&&o++<30);t.x=e;t.y=a;return t};a(i,n)};var F=function t(e,i,a){var n=e[0];var o=e[1];var r=Math.round(n[0]);var s=Math.max(Math.floor(n[1],0),0);var l=Math.min(Math.ceil(o[0],i),i-1);var h=Math.min(Math.ceil(o[1],a),a-1);return{x:r,y:s,xMax:i,yMax:h,width:i,height:a}};var H=function t(e){return e/180*Math.PI};var B=function t(i,a,n){var o=e.map.containerPointToLatLng(L.point(i,a));return[o.lng,o.lat]};var j=function t(i,a,n){var o=e.map.latLngToContainerPoint(L.latLng(i,a));return[o.x,o.y]};var q=function t(e,i,a,o){var r={};var s=(a.south-a.north)*(a.west-a.east);var l=n*Math.pow(s,.4);var h=[];var c=i.x;function f(t){var a=[];for(var n=i.y;n<=i.yMax;n+=2){var o=B(t,n);if(o){var s=o[0],c=o[1];if(isFinite(s)){var f=e.interpolate(s,c);if(f){f=V(r,s,c,t,n,l,f);a[n+1]=a[n]=f}}}}h[t+1]=h[t]=a}(function t(){var e=Date.now();while(c<i.width){f(c);c+=2;if(Date.now()-e>1e3){setTimeout(t,25);return}}k(h,i,o)})()};var I;var Z=function t(n,h){function v(t,e){d.indexFor=function(i){return Math.max(0,Math.min(d.length-1,Math.round((i-t)/(e-t)*(d.length-1))))};return d}var u=v(i,a);var p=u.map((function(){return[]}));var m=Math.round(n.width*n.height*s);if(E()){m*=l}var y="rgba(0, 0, 0, ".concat(f,")");var _=[];for(var g=0;g<m;g++){_.push(h.randomize({age:Math.floor(Math.random()*o)+0}))}function L(){p.forEach((function(t){t.length=0}));_.forEach((function(t){if(t.age>o){h.randomize(t).age=0}var e=t.x;var i=t.y;var a=h(e,i);var n=a[2];if(n===null){t.age=o}else{var r=e+a[0];var s=i+a[1];if(h(r,s)[2]!==null){t.xt=r;t.yt=s;p[u.indexFor(n)].push(t)}else{t.x=r;t.y=s}}t.age+=1}))}var w=e.canvas.getContext("2d");w.lineWidth=r;w.fillStyle=y;w.globalAlpha=.6;function M(){var t="lighter";w.globalCompositeOperation="destination-in";w.fillRect(n.x,n.y,n.width,n.height);w.globalCompositeOperation=t;w.globalAlpha=f===0?0:f*.9;p.forEach((function(t,e){if(t.length>0){w.beginPath();w.strokeStyle=u[e];t.forEach((function(t){w.moveTo(t.x,t.y);w.lineTo(t.xt,t.yt);t.x=t.xt;t.y=t.yt}));w.stroke()}}))}var x=Date.now();(function t(){I=requestAnimationFrame(t);var e=Date.now();var i=e-x;if(i>c){x=e-i%c;L();M()}})()};var K=function t(e,i,a,n){var o={south:H(n[0][1]),north:H(n[1][1]),east:H(n[1][0]),west:H(n[0][0]),width:i,height:a};G();W(y,(function(t){q(t,F(e,i,a),o,(function(t,e){J.field=e;Z(t,e)}))}))};var G=function t(){if(J.field)J.field.release();if(I)cancelAnimationFrame(I)};var J={params:e,start:K,stop:G,createField:k,interpolatePoint:R,setData:P,setOptions:S};return J};if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(t){clearTimeout(t)}}}}]);
//# sourceMappingURL=8687.b304b28ff1d0e1b96bb3.js.map?v=b304b28ff1d0e1b96bb3